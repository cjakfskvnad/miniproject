
Creating environment (sequence length = 10)...
Creating Transformer model...
Creating DQN agent...

Total parameters: 201347
Device: cuda

Starting training for 1000 episodes...
============================================================
Training:   0%|                                                                                | 0/1000 [00:00<?, ?it/s]/workspace/train_dqn.py:277: UserWarning: Creating a tensor from a list of numpy.ndarrays is extremely slow. Please consider converting the list to a single numpy.ndarray with numpy.array() before converting to a tensor. (Triggered internally at /app/pytorch/torch/csrc/utils/tensor_new.cpp:254.)
  state_tensor = torch.tensor([state], dtype=torch.long)

Episode 10/1000
  Avg Reward: 0.80/10
  Avg Accuracy: 8.00%
  Avg Loss: 0.0000
  Epsilon: 0.9511
  Buffer Size: 18

Episode 20/1000
  Avg Reward: 0.50/10
  Avg Accuracy: 5.00%
  Avg Loss: 0.0000
  Epsilon: 0.9046
  Buffer Size: 33
Training:   7%|████▊                                                                  | 67/1000 [00:11<02:08,  7.29it/s]

Episode 30/1000
  Avg Reward: 1.10/10
  Avg Accuracy: 11.00%
  Avg Loss: 0.0000
  Epsilon: 0.8604
  Buffer Size: 54

Episode 40/1000
  Avg Reward: 0.30/10
  Avg Accuracy: 3.00%
  Avg Loss: 0.0000
  Epsilon: 0.8183
  Buffer Size: 67

Episode 50/1000
  Avg Reward: 0.90/10
  Avg Accuracy: 9.00%
  Avg Loss: 0.0000
  Epsilon: 0.7783
  Buffer Size: 86

Episode 60/1000
  Avg Reward: 1.40/10
  Avg Accuracy: 14.00%
  Avg Loss: 0.0000
  Epsilon: 0.7403
  Buffer Size: 110

Episode 70/1000
  Avg Reward: 0.30/10
  Avg Accuracy: 3.00%
  Avg Loss: 0.0000
  Epsilon: 0.7041
  Buffer Size: 123

Episode 80/1000
  Avg Reward: 1.40/10
  Avg Accuracy: 14.00%
  Avg Loss: 0.0000
  Epsilon: 0.6696
  Buffer Size: 147

Episode 90/1000
  Avg Reward: 1.00/10
  Avg Accuracy: 10.00%
  Avg Loss: 0.0000
  Epsilon: 0.6369
  Buffer Size: 167

Episode 100/1000
  Avg Reward: 0.60/10
  Avg Accuracy: 6.00%
  Avg Loss: 0.0000
  Epsilon: 0.6058
  Buffer Size: 183

Episode 110/1000
  Avg Reward: 1.00/10
  Avg Accuracy: 10.00%
  Avg Loss: 0.0000
  Epsilon: 0.5762
  Buffer Size: 203

Episode 120/1000
  Avg Reward: 0.60/10
  Avg Accuracy: 6.00%
  Avg Loss: 0.0000
  Epsilon: 0.5480
  Buffer Size: 219

Episode 130/1000
  Avg Reward: 0.90/10
  Avg Accuracy: 9.00%
  Avg Loss: 0.0000
  Epsilon: 0.5212
  Buffer Size: 238

Episode 140/1000
  Avg Reward: 1.20/10
  Avg Accuracy: 12.00%
  Avg Loss: 0.0000
  Epsilon: 0.4957
  Buffer Size: 260

Episode 150/1000
  Avg Reward: 1.10/10
  Avg Accuracy: 11.00%
  Avg Loss: 0.0000
  Epsilon: 0.4715
  Buffer Size: 281

Episode 160/1000
  Avg Reward: 0.60/10
  Avg Accuracy: 6.00%
  Avg Loss: 0.0000
  Epsilon: 0.4484
  Buffer Size: 297

Episode 170/1000
  Avg Reward: 1.20/10
  Avg Accuracy: 12.00%
  Avg Loss: 0.0000
  Epsilon: 0.4265
  Buffer Size: 319

Episode 180/1000
  Avg Reward: 0.50/10
  Avg Accuracy: 5.00%
  Avg Loss: 0.0000
  Epsilon: 0.4057
  Buffer Size: 334

Episode 190/1000
  Avg Reward: 1.60/10
  Avg Accuracy: 16.00%
  Avg Loss: 0.0000
  Epsilon: 0.3858
  Buffer Size: 360

Episode 200/1000
  Avg Reward: 0.70/10
  Avg Accuracy: 7.00%
  Avg Loss: 0.0000
  Epsilon: 0.3670
  Buffer Size: 377

Episode 210/1000
  Avg Reward: 1.70/10
  Avg Accuracy: 17.00%
  Avg Loss: 0.0000
  Epsilon: 0.3490
  Buffer Size: 404

Episode 220/1000
  Avg Reward: 1.30/10
  Avg Accuracy: 13.00%
  Avg Loss: 0.0000
  Epsilon: 0.3320
  Buffer Size: 427

Episode 230/1000
  Avg Reward: 1.70/10
  Avg Accuracy: 17.00%
  Avg Loss: 0.0000
  Epsilon: 0.3157
  Buffer Size: 454

Episode 240/1000
  Avg Reward: 0.80/10
  Avg Accuracy: 8.00%
  Avg Loss: 0.0000
  Epsilon: 0.3003
  Buffer Size: 472

Episode 250/1000
  Avg Reward: 0.60/10
  Avg Accuracy: 6.00%
  Avg Loss: 0.0000
  Epsilon: 0.2856
  Buffer Size: 488

Episode 260/1000
  Avg Reward: 0.80/10
  Avg Accuracy: 8.00%
  Avg Loss: 0.0000
  Epsilon: 0.2716
  Buffer Size: 506

Episode 270/1000
  Avg Reward: 0.70/10
  Avg Accuracy: 7.00%
  Avg Loss: 0.0000
  Epsilon: 0.2584
  Buffer Size: 523

Episode 280/1000
  Avg Reward: 1.50/10
  Avg Accuracy: 15.00%
  Avg Loss: 0.0000
  Epsilon: 0.2457
  Buffer Size: 548

Episode 290/1000
  Avg Reward: 0.40/10
  Avg Accuracy: 4.00%
  Avg Loss: 0.0000
  Epsilon: 0.2337
  Buffer Size: 562

Episode 300/1000
  Avg Reward: 1.30/10
  Avg Accuracy: 13.00%
  Avg Loss: 0.0000
  Epsilon: 0.2223
  Buffer Size: 585

Episode 310/1000
  Avg Reward: 1.30/10
  Avg Accuracy: 13.00%
  Avg Loss: 0.0000
  Epsilon: 0.2114
  Buffer Size: 608

Episode 320/1000
  Avg Reward: 0.90/10
  Avg Accuracy: 9.00%
  Avg Loss: 0.0000
  Epsilon: 0.2011
  Buffer Size: 627

Episode 330/1000
  Avg Reward: 1.00/10
  Avg Accuracy: 10.00%
  Avg Loss: 0.0000
  Epsilon: 0.1913
  Buffer Size: 647

Episode 340/1000
  Avg Reward: 1.00/10
  Avg Accuracy: 10.00%
  Avg Loss: 0.0000
  Epsilon: 0.1819
  Buffer Size: 667

Episode 350/1000
  Avg Reward: 1.40/10
  Avg Accuracy: 14.00%
  Avg Loss: 0.0000
  Epsilon: 0.1730
  Buffer Size: 691

Episode 360/1000
  Avg Reward: 0.80/10
  Avg Accuracy: 8.00%
  Avg Loss: 0.0000
  Epsilon: 0.1646
  Buffer Size: 709

Episode 370/1000
  Avg Reward: 1.50/10
  Avg Accuracy: 15.00%
  Avg Loss: 0.0000
  Epsilon: 0.1565
  Buffer Size: 734

Episode 380/1000
  Avg Reward: 1.80/10
  Avg Accuracy: 18.00%
  Avg Loss: 0.0000
  Epsilon: 0.1489
  Buffer Size: 762

Episode 390/1000
  Avg Reward: 0.50/10
  Avg Accuracy: 5.00%
  Avg Loss: 0.0000
  Epsilon: 0.1416
  Buffer Size: 777

Episode 400/1000
  Avg Reward: 0.70/10
  Avg Accuracy: 7.00%
  Avg Loss: 0.0000
  Epsilon: 0.1347
  Buffer Size: 794

Episode 410/1000
  Avg Reward: 1.10/10
  Avg Accuracy: 11.00%
  Avg Loss: 0.0000
  Epsilon: 0.1281
  Buffer Size: 815

Episode 420/1000
  Avg Reward: 2.40/10
  Avg Accuracy: 24.00%
  Avg Loss: 0.0000
  Epsilon: 0.1218
  Buffer Size: 849

Episode 430/1000
  Avg Reward: 0.60/10
  Avg Accuracy: 6.00%
  Avg Loss: 0.0000
  Epsilon: 0.1159
  Buffer Size: 865

Episode 440/1000
  Avg Reward: 0.50/10
  Avg Accuracy: 5.00%
  Avg Loss: 0.0000
  Epsilon: 0.1102
  Buffer Size: 880

Episode 450/1000
  Avg Reward: 2.20/10
  Avg Accuracy: 22.00%
  Avg Loss: 0.0000
  Epsilon: 0.1048
  Buffer Size: 911

Episode 460/1000
  Avg Reward: 1.70/10
  Avg Accuracy: 17.00%
  Avg Loss: 0.0000
  Epsilon: 0.0997
  Buffer Size: 938

Episode 470/1000
  Avg Reward: 1.30/10
  Avg Accuracy: 13.00%
  Avg Loss: 0.0000
  Epsilon: 0.0948
  Buffer Size: 961

Episode 480/1000
  Avg Reward: 1.20/10
  Avg Accuracy: 12.00%
  Avg Loss: 0.0000
  Epsilon: 0.0902
  Buffer Size: 983

Episode 490/1000
  Avg Reward: 0.70/10
  Avg Accuracy: 7.00%
  Avg Loss: 0.0000
  Epsilon: 0.0858
  Buffer Size: 1000

Episode 500/1000
  Avg Reward: 1.20/10
  Avg Accuracy: 12.00%
  Avg Loss: 0.0000
  Epsilon: 0.0816
  Buffer Size: 1022

Episode 510/1000
  Avg Reward: 1.10/10
  Avg Accuracy: 11.00%
  Avg Loss: 0.3411
  Epsilon: 0.0776
  Buffer Size: 1043

Episode 520/1000
  Avg Reward: 2.00/10
  Avg Accuracy: 20.00%
  Avg Loss: 0.4956
  Epsilon: 0.0738
  Buffer Size: 1073

Episode 530/1000
  Avg Reward: 3.00/10
  Avg Accuracy: 30.00%
  Avg Loss: 0.6870
  Epsilon: 0.0702
  Buffer Size: 1113

Episode 540/1000
  Avg Reward: 3.30/10
  Avg Accuracy: 33.00%
  Avg Loss: 0.9845
  Epsilon: 0.0668
  Buffer Size: 1156

Episode 550/1000
  Avg Reward: 2.20/10
  Avg Accuracy: 22.00%
  Avg Loss: 1.2706
  Epsilon: 0.0635
  Buffer Size: 1188

Episode 560/1000
  Avg Reward: 2.00/10
  Avg Accuracy: 20.00%
  Avg Loss: 1.6095
  Epsilon: 0.0604
  Buffer Size: 1218

Episode 570/1000
  Avg Reward: 3.70/10
  Avg Accuracy: 37.00%
  Avg Loss: 1.8596
  Epsilon: 0.0574
  Buffer Size: 1265

Episode 580/1000
  Avg Reward: 3.20/10
  Avg Accuracy: 32.00%
  Avg Loss: 2.0257
  Epsilon: 0.0546
  Buffer Size: 1307

Episode 590/1000
  Avg Reward: 4.00/10
  Avg Accuracy: 40.00%
  Avg Loss: 2.1353
  Epsilon: 0.0520
  Buffer Size: 1357

Episode 600/1000
  Avg Reward: 2.90/10
  Avg Accuracy: 29.00%
  Avg Loss: 2.2789
  Epsilon: 0.0494
  Buffer Size: 1396

Episode 610/1000
  Avg Reward: 3.30/10
  Avg Accuracy: 33.00%
  Avg Loss: 2.2964
  Epsilon: 0.0470
  Buffer Size: 1439

Episode 620/1000
  Avg Reward: 3.10/10
  Avg Accuracy: 31.00%
  Avg Loss: 2.2752
  Epsilon: 0.0447
  Buffer Size: 1480

Episode 630/1000
  Avg Reward: 3.70/10
  Avg Accuracy: 37.00%
  Avg Loss: 2.1733
  Epsilon: 0.0425
  Buffer Size: 1527

Episode 640/1000
  Avg Reward: 3.70/10
  Avg Accuracy: 37.00%
  Avg Loss: 1.9736
  Epsilon: 0.0404
  Buffer Size: 1574

Episode 650/1000
  Avg Reward: 3.90/10
  Avg Accuracy: 39.00%
  Avg Loss: 1.9414
  Epsilon: 0.0385
  Buffer Size: 1623

Episode 660/1000
  Avg Reward: 2.50/10
  Avg Accuracy: 25.00%
  Avg Loss: 1.6134
  Epsilon: 0.0366
  Buffer Size: 1658

Episode 670/1000
  Avg Reward: 2.50/10
  Avg Accuracy: 25.00%
  Avg Loss: 1.5395
  Epsilon: 0.0348
  Buffer Size: 1693

Episode 680/1000
  Avg Reward: 3.60/10
  Avg Accuracy: 36.00%
  Avg Loss: 1.5009
  Epsilon: 0.0331
  Buffer Size: 1739

Episode 690/1000
  Avg Reward: 4.60/10
  Avg Accuracy: 46.00%
  Avg Loss: 1.3725
  Epsilon: 0.0315
  Buffer Size: 1794

Episode 700/1000
  Avg Reward: 4.00/10
  Avg Accuracy: 40.00%
  Avg Loss: 1.3534
  Epsilon: 0.0299
  Buffer Size: 1844

Episode 710/1000
  Avg Reward: 4.60/10
  Avg Accuracy: 46.00%
  Avg Loss: 1.3147
  Epsilon: 0.0285
  Buffer Size: 1899

Episode 720/1000
  Avg Reward: 3.50/10
  Avg Accuracy: 35.00%
  Avg Loss: 1.3672
  Epsilon: 0.0271
  Buffer Size: 1944

Episode 730/1000
  Avg Reward: 4.30/10
  Avg Accuracy: 43.00%
  Avg Loss: 1.3743
  Epsilon: 0.0258
  Buffer Size: 1997

Episode 740/1000
  Avg Reward: 4.00/10
  Avg Accuracy: 40.00%
  Avg Loss: 1.3826
  Epsilon: 0.0245
  Buffer Size: 2047

Episode 750/1000
  Avg Reward: 4.00/10
  Avg Accuracy: 40.00%
  Avg Loss: 1.4138
  Epsilon: 0.0233
  Buffer Size: 2097

Episode 760/1000
  Avg Reward: 4.40/10
  Avg Accuracy: 44.00%
  Avg Loss: 1.3922
  Epsilon: 0.0222
  Buffer Size: 2150

Episode 770/1000
  Avg Reward: 4.90/10
  Avg Accuracy: 49.00%
  Avg Loss: 1.3355
  Epsilon: 0.0211
  Buffer Size: 2208

Episode 780/1000
  Avg Reward: 3.50/10
  Avg Accuracy: 35.00%
  Avg Loss: 1.2686
  Epsilon: 0.0200
  Buffer Size: 2253

Episode 790/1000
  Avg Reward: 5.60/10
  Avg Accuracy: 56.00%
  Avg Loss: 1.3564
  Epsilon: 0.0191
  Buffer Size: 2318

Episode 800/1000
  Avg Reward: 4.10/10
  Avg Accuracy: 41.00%
  Avg Loss: 1.2659
  Epsilon: 0.0181
  Buffer Size: 2368

Episode 810/1000
  Avg Reward: 4.60/10
  Avg Accuracy: 46.00%
  Avg Loss: 1.2437
  Epsilon: 0.0172
  Buffer Size: 2424

Episode 820/1000
  Avg Reward: 4.60/10
  Avg Accuracy: 46.00%
  Avg Loss: 1.1611
  Epsilon: 0.0164
  Buffer Size: 2479

Episode 830/1000
  Avg Reward: 5.00/10
  Avg Accuracy: 50.00%
  Avg Loss: 1.1005
  Epsilon: 0.0156
  Buffer Size: 2539

Episode 840/1000
  Avg Reward: 3.60/10
  Avg Accuracy: 36.00%
  Avg Loss: 1.1076
  Epsilon: 0.0148
  Buffer Size: 2585

Episode 850/1000
  Avg Reward: 5.00/10
  Avg Accuracy: 50.00%
  Avg Loss: 1.0362
  Epsilon: 0.0141
  Buffer Size: 2645

Episode 860/1000
  Avg Reward: 4.80/10
  Avg Accuracy: 48.00%
  Avg Loss: 1.0263
  Epsilon: 0.0134
  Buffer Size: 2702

Episode 870/1000
  Avg Reward: 6.10/10
  Avg Accuracy: 61.00%
  Avg Loss: 0.9956
  Epsilon: 0.0128
  Buffer Size: 2773

Episode 880/1000
  Avg Reward: 4.10/10
  Avg Accuracy: 41.00%
  Avg Loss: 0.9293
  Epsilon: 0.0121
  Buffer Size: 2824

Episode 890/1000
  Avg Reward: 3.50/10
  Avg Accuracy: 35.00%
  Avg Loss: 0.8614
  Epsilon: 0.0115
  Buffer Size: 2869

Episode 900/1000
  Avg Reward: 4.40/10
  Avg Accuracy: 44.00%
  Avg Loss: 0.7739
  Epsilon: 0.0110
  Buffer Size: 2923

Episode 910/1000
  Avg Reward: 3.60/10
  Avg Accuracy: 36.00%
  Avg Loss: 0.7536
  Epsilon: 0.0104
  Buffer Size: 2969

Episode 920/1000
  Avg Reward: 4.20/10
  Avg Accuracy: 42.00%
  Avg Loss: 0.7355
  Epsilon: 0.0100
  Buffer Size: 3021

Episode 930/1000
  Avg Reward: 3.90/10
  Avg Accuracy: 39.00%
  Avg Loss: 0.7174
  Epsilon: 0.0100
  Buffer Size: 3070

Episode 940/1000
  Avg Reward: 4.20/10
  Avg Accuracy: 42.00%
  Avg Loss: 0.6919
  Epsilon: 0.0100
  Buffer Size: 3122

Episode 950/1000
  Avg Reward: 4.70/10
  Avg Accuracy: 47.00%
  Avg Loss: 0.7272
  Epsilon: 0.0100
  Buffer Size: 3179

Episode 960/1000
  Avg Reward: 5.00/10
  Avg Accuracy: 50.00%
  Avg Loss: 0.6787
  Epsilon: 0.0100
  Buffer Size: 3239

Episode 970/1000
  Avg Reward: 4.90/10
  Avg Accuracy: 49.00%
  Avg Loss: 0.6835
  Epsilon: 0.0100
  Buffer Size: 3297

Episode 980/1000
  Avg Reward: 4.60/10
  Avg Accuracy: 46.00%
  Avg Loss: 0.6959
  Epsilon: 0.0100
  Buffer Size: 3353

Episode 990/1000
  Avg Reward: 4.50/10
  Avg Accuracy: 45.00%
  Avg Loss: 0.6929
  Epsilon: 0.0100
  Buffer Size: 3408

Episode 1000/1000
  Avg Reward: 4.60/10
  Avg Accuracy: 46.00%
  Avg Loss: 0.6295
  Epsilon: 0.0100
  Buffer Size: 3464
Agent saved to checkpoints/agent_final.pt

============================================================
Evaluating trained agent...
============================================================
Episode 1: Reward = 4.0/10, Accuracy = 40.00%
  Target:    [0 0 0 1 0 0 1 1 1 1]
  Generated: [0 0 0 1 1]
Episode 2: Reward = 10.0/10, Accuracy = 100.00%
  Target:    [0 0 0 0 0 0 0 0 1 1]
  Generated: [0 0 0 0 0 0 0 0 1 1]
Episode 3: Reward = 7.0/10, Accuracy = 70.00%
  Target:    [1 0 1 1 1 1 1 0 0 1]
  Generated: [1 0 1 1 1 1 1 1]
Episode 4: Reward = 8.0/10, Accuracy = 80.00%
  Target:    [1 1 1 0 1 1 1 1 0 1]
  Generated: [1 1 1 0 1 1 1 1 1]
Episode 5: Reward = 8.0/10, Accuracy = 80.00%
  Target:    [0 0 0 0 0 0 0 1 0 0]
  Generated: [0 0 0 0 0 0 0 1 1]
Episode 6: Reward = 6.0/10, Accuracy = 60.00%
  Target:    [1 1 1 0 1 1 0 1 1 1]
  Generated: [1 1 1 0 1 1 1]
Episode 7: Reward = 7.0/10, Accuracy = 70.00%
  Target:    [1 1 0 1 1 1 1 0 1 1]
  Generated: [1 1 0 1 1 1 1 1]
Episode 8: Reward = 5.0/10, Accuracy = 50.00%
  Target:    [1 0 1 0 1 0 1 1 0 0]
  Generated: [1 0 1 0 1 1]
Episode 9: Reward = 5.0/10, Accuracy = 50.00%
  Target:    [0 1 1 1 1 0 1 1 1 1]
  Generated: [0 1 1 1 1 1]
Episode 10: Reward = 10.0/10, Accuracy = 100.00%
  Target:    [0 0 0 0 0 0 0 1 1 1]
  Generated: [0 0 0 0 0 0 0 1 1 1]

Average Accuracy: 70.00%

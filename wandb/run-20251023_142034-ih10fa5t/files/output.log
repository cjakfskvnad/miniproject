
Creating environment (sequence length = 10)...
Creating Transformer model...
Creating DQN agent...

Total parameters: 100867
Device: cuda

Starting training for 1000 episodes...
============================================================
Training:   0%|                                                                                | 0/1000 [00:00<?, ?it/s]/workspace/train_dqn.py:296: UserWarning: Creating a tensor from a list of numpy.ndarrays is extremely slow. Please consider converting the list to a single numpy.ndarray with numpy.array() before converting to a tensor. (Triggered internally at /app/pytorch/torch/csrc/utils/tensor_new.cpp:254.)
  state_tensor = torch.tensor([state], dtype=torch.long)

Episode 10/1000
  Avg Reward: 0.30/10
  Avg Accuracy: 3.00%
  Avg Loss: 0.0000
  Epsilon: 0.9511
  Buffer Size: 13
Training:   5%|███▌                                                                   | 50/1000 [00:11<02:51,  5.55it/s]

Episode 20/1000
  Avg Reward: 0.80/10
  Avg Accuracy: 8.00%
  Avg Loss: 0.0000
  Epsilon: 0.9046
  Buffer Size: 31

Episode 30/1000
  Avg Reward: 0.60/10
  Avg Accuracy: 6.00%
  Avg Loss: 0.0000
  Epsilon: 0.8604
  Buffer Size: 47

Episode 40/1000
  Avg Reward: 1.20/10
  Avg Accuracy: 12.00%
  Avg Loss: 0.0000
  Epsilon: 0.8183
  Buffer Size: 69

Episode 50/1000
  Avg Reward: 0.90/10
  Avg Accuracy: 9.00%
  Avg Loss: 0.0000
  Epsilon: 0.7783
  Buffer Size: 88

Episode 60/1000
  Avg Reward: 0.30/10
  Avg Accuracy: 3.00%
  Avg Loss: 0.0000
  Epsilon: 0.7403
  Buffer Size: 101

Episode 70/1000
  Avg Reward: 0.80/10
  Avg Accuracy: 8.00%
  Avg Loss: 0.0000
  Epsilon: 0.7041
  Buffer Size: 119

Episode 80/1000
  Avg Reward: 0.70/10
  Avg Accuracy: 7.00%
  Avg Loss: 0.0000
  Epsilon: 0.6696
  Buffer Size: 136

Episode 90/1000
  Avg Reward: 0.90/10
  Avg Accuracy: 9.00%
  Avg Loss: 0.0000
  Epsilon: 0.6369
  Buffer Size: 155

Episode 100/1000
  Avg Reward: 0.60/10
  Avg Accuracy: 6.00%
  Avg Loss: 0.0000
  Epsilon: 0.6058
  Buffer Size: 171
Agent saved to checkpoints/agent_episode_100.pt

Episode 110/1000
  Avg Reward: 0.80/10
  Avg Accuracy: 8.00%
  Avg Loss: 0.0000
  Epsilon: 0.5762
  Buffer Size: 189

Episode 120/1000
  Avg Reward: 0.90/10
  Avg Accuracy: 9.00%
  Avg Loss: 0.0000
  Epsilon: 0.5480
  Buffer Size: 208

Episode 130/1000
  Avg Reward: 0.70/10
  Avg Accuracy: 7.00%
  Avg Loss: 0.0000
  Epsilon: 0.5212
  Buffer Size: 225

Episode 140/1000
  Avg Reward: 1.50/10
  Avg Accuracy: 15.00%
  Avg Loss: 0.0000
  Epsilon: 0.4957
  Buffer Size: 250

Episode 150/1000
  Avg Reward: 0.60/10
  Avg Accuracy: 6.00%
  Avg Loss: 0.0000
  Epsilon: 0.4715
  Buffer Size: 266

Episode 160/1000
  Avg Reward: 0.60/10
  Avg Accuracy: 6.00%
  Avg Loss: 0.0000
  Epsilon: 0.4484
  Buffer Size: 282

Episode 170/1000
  Avg Reward: 1.10/10
  Avg Accuracy: 11.00%
  Avg Loss: 0.0000
  Epsilon: 0.4265
  Buffer Size: 303

Episode 180/1000
  Avg Reward: 1.00/10
  Avg Accuracy: 10.00%
  Avg Loss: 0.0000
  Epsilon: 0.4057
  Buffer Size: 323

Episode 190/1000
  Avg Reward: 0.60/10
  Avg Accuracy: 6.00%
  Avg Loss: 0.0000
  Epsilon: 0.3858
  Buffer Size: 339

Episode 200/1000
  Avg Reward: 0.80/10
  Avg Accuracy: 8.00%
  Avg Loss: 0.0000
  Epsilon: 0.3670
  Buffer Size: 357
Agent saved to checkpoints/agent_episode_200.pt

Episode 210/1000
  Avg Reward: 0.60/10
  Avg Accuracy: 6.00%
  Avg Loss: 0.0000
  Epsilon: 0.3490
  Buffer Size: 373

Episode 220/1000
  Avg Reward: 0.00/10
  Avg Accuracy: 0.00%
  Avg Loss: 0.0000
  Epsilon: 0.3320
  Buffer Size: 383

Episode 230/1000
  Avg Reward: 1.30/10
  Avg Accuracy: 13.00%
  Avg Loss: 0.0000
  Epsilon: 0.3157
  Buffer Size: 406

Episode 240/1000
  Avg Reward: 0.50/10
  Avg Accuracy: 5.00%
  Avg Loss: 0.0000
  Epsilon: 0.3003
  Buffer Size: 421

Episode 250/1000
  Avg Reward: 0.70/10
  Avg Accuracy: 7.00%
  Avg Loss: 0.0000
  Epsilon: 0.2856
  Buffer Size: 438

Episode 260/1000
  Avg Reward: 0.70/10
  Avg Accuracy: 7.00%
  Avg Loss: 0.0000
  Epsilon: 0.2716
  Buffer Size: 455

Episode 270/1000
  Avg Reward: 2.20/10
  Avg Accuracy: 22.00%
  Avg Loss: 0.0000
  Epsilon: 0.2584
  Buffer Size: 487

Episode 280/1000
  Avg Reward: 1.50/10
  Avg Accuracy: 15.00%
  Avg Loss: 0.0000
  Epsilon: 0.2457
  Buffer Size: 512

Episode 290/1000
  Avg Reward: 0.70/10
  Avg Accuracy: 7.00%
  Avg Loss: 0.0000
  Epsilon: 0.2337
  Buffer Size: 529

Episode 300/1000
  Avg Reward: 0.40/10
  Avg Accuracy: 4.00%
  Avg Loss: 0.0000
  Epsilon: 0.2223
  Buffer Size: 543
Agent saved to checkpoints/agent_episode_300.pt

Episode 310/1000
  Avg Reward: 1.70/10
  Avg Accuracy: 17.00%
  Avg Loss: 0.0000
  Epsilon: 0.2114
  Buffer Size: 570

Episode 320/1000
  Avg Reward: 0.90/10
  Avg Accuracy: 9.00%
  Avg Loss: 0.0000
  Epsilon: 0.2011
  Buffer Size: 589

Episode 330/1000
  Avg Reward: 1.30/10
  Avg Accuracy: 13.00%
  Avg Loss: 0.0000
  Epsilon: 0.1913
  Buffer Size: 612

Episode 340/1000
  Avg Reward: 1.50/10
  Avg Accuracy: 15.00%
  Avg Loss: 0.0000
  Epsilon: 0.1819
  Buffer Size: 637

Episode 350/1000
  Avg Reward: 1.40/10
  Avg Accuracy: 14.00%
  Avg Loss: 0.0000
  Epsilon: 0.1730
  Buffer Size: 661

Episode 360/1000
  Avg Reward: 0.60/10
  Avg Accuracy: 6.00%
  Avg Loss: 0.0000
  Epsilon: 0.1646
  Buffer Size: 677

Episode 370/1000
  Avg Reward: 1.40/10
  Avg Accuracy: 14.00%
  Avg Loss: 0.0000
  Epsilon: 0.1565
  Buffer Size: 701

Episode 380/1000
  Avg Reward: 1.30/10
  Avg Accuracy: 13.00%
  Avg Loss: 0.0000
  Epsilon: 0.1489
  Buffer Size: 724

Episode 390/1000
  Avg Reward: 0.70/10
  Avg Accuracy: 7.00%
  Avg Loss: 0.0000
  Epsilon: 0.1416
  Buffer Size: 741

Episode 400/1000
  Avg Reward: 1.80/10
  Avg Accuracy: 18.00%
  Avg Loss: 0.0000
  Epsilon: 0.1347
  Buffer Size: 769
Agent saved to checkpoints/agent_episode_400.pt

Episode 410/1000
  Avg Reward: 0.70/10
  Avg Accuracy: 7.00%
  Avg Loss: 0.0000
  Epsilon: 0.1281
  Buffer Size: 786

Episode 420/1000
  Avg Reward: 1.20/10
  Avg Accuracy: 12.00%
  Avg Loss: 0.0000
  Epsilon: 0.1218
  Buffer Size: 808

Episode 430/1000
  Avg Reward: 1.10/10
  Avg Accuracy: 11.00%
  Avg Loss: 0.0000
  Epsilon: 0.1159
  Buffer Size: 829

Episode 440/1000
  Avg Reward: 1.00/10
  Avg Accuracy: 10.00%
  Avg Loss: 0.0000
  Epsilon: 0.1102
  Buffer Size: 849

Episode 450/1000
  Avg Reward: 1.10/10
  Avg Accuracy: 11.00%
  Avg Loss: 0.0000
  Epsilon: 0.1048
  Buffer Size: 870

Episode 460/1000
  Avg Reward: 1.10/10
  Avg Accuracy: 11.00%
  Avg Loss: 0.0000
  Epsilon: 0.0997
  Buffer Size: 891

Episode 470/1000
  Avg Reward: 0.90/10
  Avg Accuracy: 9.00%
  Avg Loss: 0.0000
  Epsilon: 0.0948
  Buffer Size: 910

Episode 480/1000
  Avg Reward: 1.60/10
  Avg Accuracy: 16.00%
  Avg Loss: 0.0000
  Epsilon: 0.0902
  Buffer Size: 936

Episode 490/1000
  Avg Reward: 0.80/10
  Avg Accuracy: 8.00%
  Avg Loss: 0.0000
  Epsilon: 0.0858
  Buffer Size: 954

Episode 500/1000
  Avg Reward: 1.20/10
  Avg Accuracy: 12.00%
  Avg Loss: 0.0000
  Epsilon: 0.0816
  Buffer Size: 976
Agent saved to checkpoints/agent_episode_500.pt

Episode 510/1000
  Avg Reward: 0.30/10
  Avg Accuracy: 3.00%
  Avg Loss: 0.0000
  Epsilon: 0.0776
  Buffer Size: 989

Episode 520/1000
  Avg Reward: 1.70/10
  Avg Accuracy: 17.00%
  Avg Loss: 0.0000
  Epsilon: 0.0738
  Buffer Size: 1016

Episode 530/1000
  Avg Reward: 1.00/10
  Avg Accuracy: 10.00%
  Avg Loss: 0.3984
  Epsilon: 0.0702
  Buffer Size: 1036

Episode 540/1000
  Avg Reward: 0.60/10
  Avg Accuracy: 6.00%
  Avg Loss: 0.8927
  Epsilon: 0.0668
  Buffer Size: 1052

Episode 550/1000
  Avg Reward: 0.50/10
  Avg Accuracy: 5.00%
  Avg Loss: 0.8945
  Epsilon: 0.0635
  Buffer Size: 1067

Episode 560/1000
  Avg Reward: 2.10/10
  Avg Accuracy: 21.00%
  Avg Loss: 0.7280
  Epsilon: 0.0604
  Buffer Size: 1098

Episode 570/1000
  Avg Reward: 1.80/10
  Avg Accuracy: 18.00%
  Avg Loss: 0.7056
  Epsilon: 0.0574
  Buffer Size: 1126

Episode 580/1000
  Avg Reward: 3.40/10
  Avg Accuracy: 34.00%
  Avg Loss: 0.7483
  Epsilon: 0.0546
  Buffer Size: 1170

Episode 590/1000
  Avg Reward: 2.90/10
  Avg Accuracy: 29.00%
  Avg Loss: 0.8396
  Epsilon: 0.0520
  Buffer Size: 1209

Episode 600/1000
  Avg Reward: 3.60/10
  Avg Accuracy: 36.00%
  Avg Loss: 0.7880
  Epsilon: 0.0494
  Buffer Size: 1255
Agent saved to checkpoints/agent_episode_600.pt

Episode 610/1000
  Avg Reward: 3.10/10
  Avg Accuracy: 31.00%
  Avg Loss: 0.7787
  Epsilon: 0.0470
  Buffer Size: 1296

Episode 620/1000
  Avg Reward: 2.80/10
  Avg Accuracy: 28.00%
  Avg Loss: 0.7236
  Epsilon: 0.0447
  Buffer Size: 1334

Episode 630/1000
  Avg Reward: 2.10/10
  Avg Accuracy: 21.00%
  Avg Loss: 0.7332
  Epsilon: 0.0425
  Buffer Size: 1365

Episode 640/1000
  Avg Reward: 1.80/10
  Avg Accuracy: 18.00%
  Avg Loss: 0.7303
  Epsilon: 0.0404
  Buffer Size: 1393

Episode 650/1000
  Avg Reward: 3.20/10
  Avg Accuracy: 32.00%
  Avg Loss: 0.6865
  Epsilon: 0.0385
  Buffer Size: 1434

Episode 660/1000
  Avg Reward: 2.20/10
  Avg Accuracy: 22.00%
  Avg Loss: 0.7004
  Epsilon: 0.0366
  Buffer Size: 1466

Episode 670/1000
  Avg Reward: 3.30/10
  Avg Accuracy: 33.00%
  Avg Loss: 0.6467
  Epsilon: 0.0348
  Buffer Size: 1509

Episode 680/1000
  Avg Reward: 3.60/10
  Avg Accuracy: 36.00%
  Avg Loss: 0.6279
  Epsilon: 0.0331
  Buffer Size: 1555

Episode 690/1000
  Avg Reward: 2.20/10
  Avg Accuracy: 22.00%
  Avg Loss: 0.6491
  Epsilon: 0.0315
  Buffer Size: 1587

Episode 700/1000
  Avg Reward: 3.00/10
  Avg Accuracy: 30.00%
  Avg Loss: 0.6223
  Epsilon: 0.0299
  Buffer Size: 1627
Agent saved to checkpoints/agent_episode_700.pt

Episode 710/1000
  Avg Reward: 3.60/10
  Avg Accuracy: 36.00%
  Avg Loss: 0.6243
  Epsilon: 0.0285
  Buffer Size: 1673

Episode 720/1000
  Avg Reward: 2.90/10
  Avg Accuracy: 29.00%
  Avg Loss: 0.6397
  Epsilon: 0.0271
  Buffer Size: 1712

Episode 730/1000
  Avg Reward: 3.30/10
  Avg Accuracy: 33.00%
  Avg Loss: 0.6667
  Epsilon: 0.0258
  Buffer Size: 1755

Episode 740/1000
  Avg Reward: 3.40/10
  Avg Accuracy: 34.00%
  Avg Loss: 0.6520
  Epsilon: 0.0245
  Buffer Size: 1799

Episode 750/1000
  Avg Reward: 3.30/10
  Avg Accuracy: 33.00%
  Avg Loss: 0.6413
  Epsilon: 0.0233
  Buffer Size: 1842

Episode 760/1000
  Avg Reward: 4.20/10
  Avg Accuracy: 42.00%
  Avg Loss: 0.6804
  Epsilon: 0.0222
  Buffer Size: 1894

Episode 770/1000
  Avg Reward: 3.00/10
  Avg Accuracy: 30.00%
  Avg Loss: 0.7017
  Epsilon: 0.0211
  Buffer Size: 1934

Episode 780/1000
  Avg Reward: 4.50/10
  Avg Accuracy: 45.00%
  Avg Loss: 0.7067
  Epsilon: 0.0200
  Buffer Size: 1989

Episode 790/1000
  Avg Reward: 3.70/10
  Avg Accuracy: 37.00%
  Avg Loss: 0.6650
  Epsilon: 0.0191
  Buffer Size: 2036

Episode 800/1000
  Avg Reward: 3.80/10
  Avg Accuracy: 38.00%
  Avg Loss: 0.7108
  Epsilon: 0.0181
  Buffer Size: 2084
Agent saved to checkpoints/agent_episode_800.pt

Episode 810/1000
  Avg Reward: 2.50/10
  Avg Accuracy: 25.00%
  Avg Loss: 0.6923
  Epsilon: 0.0172
  Buffer Size: 2119

Episode 820/1000
  Avg Reward: 2.90/10
  Avg Accuracy: 29.00%
  Avg Loss: 0.7058
  Epsilon: 0.0164
  Buffer Size: 2158

Episode 830/1000
  Avg Reward: 2.50/10
  Avg Accuracy: 25.00%
  Avg Loss: 0.6728
  Epsilon: 0.0156
  Buffer Size: 2193

Episode 840/1000
  Avg Reward: 3.60/10
  Avg Accuracy: 36.00%
  Avg Loss: 0.6792
  Epsilon: 0.0148
  Buffer Size: 2239

Episode 850/1000
  Avg Reward: 3.90/10
  Avg Accuracy: 39.00%
  Avg Loss: 0.7085
  Epsilon: 0.0141
  Buffer Size: 2288

Episode 860/1000
  Avg Reward: 2.20/10
  Avg Accuracy: 22.00%
  Avg Loss: 0.6388
  Epsilon: 0.0134
  Buffer Size: 2320

Episode 870/1000
  Avg Reward: 3.00/10
  Avg Accuracy: 30.00%
  Avg Loss: 0.6918
  Epsilon: 0.0128
  Buffer Size: 2360

Episode 880/1000
  Avg Reward: 3.70/10
  Avg Accuracy: 37.00%
  Avg Loss: 0.6885
  Epsilon: 0.0121
  Buffer Size: 2407

Episode 890/1000
  Avg Reward: 2.90/10
  Avg Accuracy: 29.00%
  Avg Loss: 0.6670
  Epsilon: 0.0115
  Buffer Size: 2446

Episode 900/1000
  Avg Reward: 3.90/10
  Avg Accuracy: 39.00%
  Avg Loss: 0.6722
  Epsilon: 0.0110
  Buffer Size: 2495
Agent saved to checkpoints/agent_episode_900.pt

Episode 910/1000
  Avg Reward: 4.00/10
  Avg Accuracy: 40.00%
  Avg Loss: 0.6903
  Epsilon: 0.0104
  Buffer Size: 2544

Episode 920/1000
  Avg Reward: 3.20/10
  Avg Accuracy: 32.00%
  Avg Loss: 0.6404
  Epsilon: 0.0100
  Buffer Size: 2586

Episode 930/1000
  Avg Reward: 3.40/10
  Avg Accuracy: 34.00%
  Avg Loss: 0.6684
  Epsilon: 0.0100
  Buffer Size: 2630

Episode 940/1000
  Avg Reward: 3.70/10
  Avg Accuracy: 37.00%
  Avg Loss: 0.6435
  Epsilon: 0.0100
  Buffer Size: 2677

Episode 950/1000
  Avg Reward: 2.20/10
  Avg Accuracy: 22.00%
  Avg Loss: 0.6869
  Epsilon: 0.0100
  Buffer Size: 2709

Episode 960/1000
  Avg Reward: 2.30/10
  Avg Accuracy: 23.00%
  Avg Loss: 0.6626
  Epsilon: 0.0100
  Buffer Size: 2742

Episode 970/1000
  Avg Reward: 2.10/10
  Avg Accuracy: 21.00%
  Avg Loss: 0.6992
  Epsilon: 0.0100
  Buffer Size: 2773

Episode 980/1000
  Avg Reward: 3.60/10
  Avg Accuracy: 36.00%
  Avg Loss: 0.6863
  Epsilon: 0.0100
  Buffer Size: 2819

Episode 990/1000
  Avg Reward: 2.60/10
  Avg Accuracy: 26.00%
  Avg Loss: 0.7245
  Epsilon: 0.0100
  Buffer Size: 2855

Episode 1000/1000
  Avg Reward: 2.00/10
  Avg Accuracy: 20.00%
  Avg Loss: 0.7225
  Epsilon: 0.0100
  Buffer Size: 2885
Agent saved to checkpoints/agent_episode_1000.pt
Agent saved to checkpoints/agent_final.pt

============================================================
Evaluating trained agent...
============================================================
Episode 1: Reward = 2.0/10, Accuracy = 20.00%
  Target:    [0 1 0 1 0 1 0 1 0 1]
  Generated: [0 1 1]
Episode 2: Reward = 2.0/10, Accuracy = 20.00%
  Target:    [0 1 0 0 1 1 0 1 1 1]
  Generated: [0 1 1]
Episode 3: Reward = 8.0/10, Accuracy = 80.00%
  Target:    [1 1 1 0 1 0 1 0 0 0]
  Generated: [1 1 1 0 1 0 1 0 1]
Episode 4: Reward = 5.0/10, Accuracy = 50.00%
  Target:    [1 0 1 1 1 0 1 1 0 0]
  Generated: [1 0 1 1 1 1]
Episode 5: Reward = 4.0/10, Accuracy = 40.00%
  Target:    [1 0 1 0 0 1 0 0 0 0]
  Generated: [1 0 1 0 1]
Episode 6: Reward = 4.0/10, Accuracy = 40.00%
  Target:    [0 0 0 0 1 0 1 0 0 1]
  Generated: [0 0 0 0 0]
Episode 7: Reward = 3.0/10, Accuracy = 30.00%
  Target:    [0 1 0 0 1 0 0 1 0 0]
  Generated: [0 1 0 1]
Episode 8: Reward = 3.0/10, Accuracy = 30.00%
  Target:    [1 0 1 0 1 0 0 0 0 1]
  Generated: [1 0 1 1]
Episode 9: Reward = 1.0/10, Accuracy = 10.00%
  Target:    [1 0 0 1 1 1 1 1 1 1]
  Generated: [1 1]
Episode 10: Reward = 6.0/10, Accuracy = 60.00%
  Target:    [1 1 0 1 1 1 0 0 1 1]
  Generated: [1 1 0 1 1 1 1]

Average Accuracy: 38.00%
